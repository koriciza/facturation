{% extends "base.html" %}
{% block content %}
<div class="card">
    <div class="card-header">
        <h2>
            {% if client.type_client == 'person' %}
            ğŸ‘¤ {{ client.nom }} {{ client.prenom or '' }}
            {% else %}
            ğŸ¢ {{ client.nom }}
            {% endif %}
        </h2>
        <div>
            <a href="{{ url_for('client_edit', id=client.id) }}" class="btn btn-warning">âœï¸ Modifier</a>
            <a href="{{ url_for('clients_list') }}" class="btn btn-primary">â†©ï¸ Retour</a>
        </div>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
        <div class="card" style="margin: 0;">
            <h3>ğŸ“‹ Informations gÃ©nÃ©rales</h3>
            <table style="width: 100%;">
                <tr>
                    <td><strong>Type :</strong></td>
                    <td>
                        {% if client.type_client == 'person' %}
                        Personne Physique
                        {% else %}
                        SociÃ©tÃ© / Entreprise
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <td><strong>Nom / Raison sociale :</strong></td>
                    <td>{{ client.nom }}</td>
                </tr>
                {% if client.type_client == 'person' and client.prenom %}
                <tr>
                    <td><strong>PrÃ©nom :</strong></td>
                    <td>{{ client.prenom }}</td>
                </tr>
                {% endif %}
            </table>
        </div>

        {% if client.type_client == 'SociÃ©tÃ© locale' or client.type_client == 'SociÃ©tÃ© Ã©trangÃ¨re' %}

        <div class="card" style="margin: 0;">
            <h3>ğŸ“ Adresse</h3>
            <table style="width: 100%;">
                {% if client.quartier %}
                <tr>
                    <td><strong>Quartier/Colline :</strong></td>
                    <td>{{ client.quartier }}</td>
                </tr>
                {% endif %}
                {% if client.avenue %}
                <tr>
                    <td><strong>Avenue :</strong></td>
                    <td>{{ client.avenue }}</td>
                </tr>
                {% endif %}
                {% if client.numero %}
                <tr>
                    <td><strong>NumÃ©ro :</strong></td>
                    <td>{{ client.numero }}</td>
                </tr>
                {% endif %}
                {% if client.nif %}
                <tr>
                    <td><strong>NIF :</strong></td>
                    <td>{{ client.nif }}</td>
                </tr>
                {% endif %}
            </table>
        </div>
        {% endif %}
        
        <div class="card" style="margin: 0;">
            <h3>ğŸ“ Contact</h3>
            <table style="width: 100%;">
                {% if client.telephone %}
                <tr>
                    <td><strong>TÃ©lÃ©phone :</strong></td>
                    <td>{{ client.telephone }}</td>
                </tr>
                {% endif %}
                {% if client.email %}
                <tr>
                    <td><strong>Email :</strong></td>
                    <td>{{ client.email }}</td>
                </tr>
                {% endif %}
            </table>
        </div>
    </div>
    
    <div class="card" style="margin-top: 20px;">
        <h3>ğŸ“Š Factures du client</h3>
        {% if client.factures %}
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>NÂ° Facture</th>
                        <th>Date</th>
                        <th>Total</th>
                        <th>Ã‰tat</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for facture in client.factures %}
                    <tr>
                        <td>{{ facture.numero }}</td>
                        <td>{{ facture.date.strftime('%d/%m/%Y') }}</td>
                        <td>{{ "{:,.0f}".format(facture.total).replace(',', ' ') }} FBU</td>
                        <td>
                           <span class="{% if facture.etat == 'PayÃ©e' %}etat-paye{% else %}etat-impaye{% endif %}" 
                                style="padding: 5px 10px; border-radius: 5px;">
                                {{ facture.etat }}  
                            </span>
                        </td>
                        <td>
                            <a href="{{ url_for('facture_detail', id=facture.id) }}" class="btn btn-primary btn-sm">ğŸ‘ï¸</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-center">Aucune facture pour ce client</p>
        {% endif %}
    </div>
</div>
{% endblock %}

<style>
.etat-paye { background: #c6f6d5; }
.etat-impaye { background: #fed7d7; }
</style>
