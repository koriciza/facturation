<!-- stock_list.html -->
{% extends "base.html" %}
{% block content %}
<div class="container">
    <h1>üìä Gestion des Stocks</h1>
    
    <div style="margin-bottom: 20px;">
        <a href="{{ url_for('produit_new') }}" class="btn btn-success">‚ûï Nouveau Produit</a>
        <a href="{{ url_for('approvisionnements_list') }}" class="btn btn-primary">üì¶ Approvisionnements</a>
    </div>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Produit</th>
                    <th>Code</th>
                    <th>Cat√©gorie</th>
                    <th>Stock Actuel</th>
                    <th>Stock Minimum</th>
                    <th>Statut</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for produit in produits %}
                <tr>
                    <td><strong>{{ produit.nom }}</strong></td>
                    <td>{{ produit.code or '-' }}</td>
                    <td>{{ produit.categorie.nom if produit.categorie else '-' }}</td>
                    <td>
                        {% set stock_actuel = produit.stock_actuel if produit.stock_actuel is not none else 0 %}
                        {{ stock_actuel }}
                        {% if produit.unite_mesure and produit.unite_mesure.symbole %}
                            {{ produit.unite_mesure.symbole }}
                        {% endif %}
                    </td>
                    <td>
                        {% set stock_minimum = produit.stock_minimum if produit.stock_minimum is not none else 0 %}
                        {{ stock_minimum }}
                    </td>
                    <td>
                        {% set stock_actuel = produit.stock_actuel if produit.stock_actuel is not none else 0 %}
                        {% set stock_minimum = produit.stock_minimum if produit.stock_minimum is not none else 0 %}
                        
                        {% if stock_actuel <= 0 %}
                            <span class="badge badge-danger">Rupture</span>
                        {% elif stock_actuel <= stock_minimum %}
                            <span class="badge badge-warning">Stock bas</span>
                        {% else %}
                            <span class="badge badge-success">OK</span>
                        {% endif %}
                    </td>
                    <td>
                        <div class="action-buttons">
                            <a href="{{ url_for('stock_mouvements', produit_id=produit.id) }}" class="action-btn btn-info" title="Mouvements">üìä</a>
                            <a href="{{ url_for('stock_ajuster', produit_id=produit.id) }}" class="action-btn btn-warning" title="Ajuster">‚öñÔ∏è</a>
                            <a href="{{ url_for('produit_detail', id=produit.id) }}" class="action-btn btn-primary" title="Voir">üëÅÔ∏è</a>
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="7" style="text-align: center; padding: 40px;">
                        <p>Aucun produit en stock</p>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<style>
.badge {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
}
.badge-success {
    background: #d4edda;
    color: #155724;
}
.badge-warning {
    background: #fff3cd;
    color: #856404;
}
.badge-danger {
    background: #f8d7da;
    color: #721c24;
}
.action-btn {
    padding: 4px 8px;
    border: none;
    border-radius: 3px;
    cursor: pointer;
    font-size: 12px;
    text-decoration: none;
    color: white;
    display: inline-block;
}
.btn-info { background: #17a2b8; }
.btn-warning { background: #ffc107; color: #212529; }
.btn-primary { background: #007bff; }
</style>
{% endblock %}